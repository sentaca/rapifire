!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.Rapifire=e()}}(function(){return function e(n,t,o){function r(c,a){if(!t[c]){if(!n[c]){var u="function"==typeof require&&require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[c]={exports:{}};n[c][0].call(f.exports,function(e){var t=n[c][1][e];return r(t?t:e)},f,f.exports,e,n,t,o)}return t[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,n,t){"use strict";var o=e("merge"),r=function(e){var n=o({url:"wss://pubsub.sentaca.com:1443/pubsub",debug:!1,onconnect:function(){console.log("Use new Rapifire({..., onconnect: fn, ...} to overwrite this function.")},onpresence:function(e){console.log("Use new Rapifire({..., onpresence: fn, ...} to overwrite this function.",e)},onsubscribe:function(e){console.log("Use new Rapifire({..., onsubscribe: fn, ...} to overwrite this function.",e)}},e),t=n.debug||!1;t&&console.log(n);var r=function(e){return{operation:"init",data:{appId:e.appId,authId:e.authId,authKey:e.authKey}}},i=function(e,n){return{operation:"subscribe",data:{channel:e,interactive:n}}},c=function(e,n){var o=this,i=new WebSocket(e.url),c=e;return i.onopen=function(){t&&console.log("Connected to %s",e.url),i.send(JSON.stringify(r(e))),e.onconnect.apply(o)},i.onmessage=function(e){var r;try{r=JSON.parse(e.data)}catch(i){throw console.error("Received %s but cannot parse it to JSON %s",e.data,i),i}t&&console.log("Received message: %O",r),"notification/channel"===r.type&&"function"==typeof c.onpresence?c.onpresence.apply(o,[{channel:r.channel,authId:r.authId,action:r.action}]):"notification/subscription"===r.type&&"function"==typeof c.onsubscribe?c.onsubscribe.apply(o,[{channel:r.channel,authId:r.authId}]):void 0!==r.channel&&null!==r.channel&&n[r.channel]&&n[r.channel].apply(o,[r.message,r.headers])},i},a={},u=c.apply(this,[n,a]);this.subscribe=function(e){var n=[];"[object Array]"===Object.prototype.toString.call(e.channel)?n=e.channel:n.push(e.channel);var t,o=n.length,r=0;for(r=0;o>r;r++){t=n[r];var c=void 0===a[n];a[t]=e.callback,c&&u.send(JSON.stringify(i(t,e.interactive)))}return this},this.publish=function(e,n){var t={operation:"publish",data:{channel:e,message:JSON.parse(n)}};return u.send(JSON.stringify(t)),this},this.disconnect=function(){u.close()}};n.exports=r},{merge:2}],2:[function(e,n,t){!function(e){function t(e,n){if("object"!==r(e))return n;for(var o in n)"object"===r(e[o])&&"object"===r(n[o])?e[o]=t(e[o],n[o]):e[o]=n[o];return e}function o(e,n,o){var c=o[0],a=o.length;(e||"object"!==r(c))&&(c={});for(var u=0;a>u;++u){var s=o[u],f=r(s);if("object"===f)for(var l in s){var p=e?i.clone(s[l]):s[l];n?c[l]=t(c[l],p):c[l]=p}}return c}function r(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}var i=function(e){return o(e===!0,!1,arguments)},c="merge";i.recursive=function(e){return o(e===!0,!0,arguments)},i.clone=function(e){var n,t,o=e,c=r(e);if("array"===c)for(o=[],t=e.length,n=0;t>n;++n)o[n]=i.clone(e[n]);else if("object"===c){o={};for(n in e)o[n]=i.clone(e[n])}return o},e?n.exports=i:window[c]=i}("object"==typeof n&&n&&"object"==typeof n.exports&&n.exports)},{}]},{},[1])(1)});